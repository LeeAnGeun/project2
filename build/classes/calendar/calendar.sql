DROP TABLE CALENDAR
CASCADE CONSTRAINTS;

DROP SEQUENCE SEQ_CAL;

CREATE TABLE CALENDAR(
	SEQ NUMBER(8) PRIMARY KEY,
	ID VARCHAR2(50) NOT NULL,
	TITLE VARCHAR2(200) NOT NULL,
	CONTENT VARCHAR2(4000),
	RDATE VARCHAR2(12) NOT NULL, -- 약속날짜 
	WDATE DATE NOT NULL -- 오늘 날짜
);

CREATE SEQUENCE SEQ_CAL
START WITH 1
INCREMENT BY 1;

ALTER TABLE CALENDAR 
ADD CONSTRAINT FK_CAL_ID FOREIGN KEY(ID)
REFERENCES MEMBER(ID);


SELECT SEQ, ID, TITLE, CONTENT, RDATE, WDATE
FROM 
	(SELECT ROW_NUMBER()OVER(PARTITION BY SUBSTR(RDATE, 1, 8)ORDER BY RDATE ASC) AS RNUM, -- (20210309 20210309) 20210310 20210314 ->  ORDER BY를 통해 순서대로 정렬을 한후 PARTITION으로 같은 날에 약속을 묶어준다
			SEQ, ID, TITLE, CONTENT, RDATE, WDATE
	FROM CALENDAR
	WHERE ID='dd' AND SUBSTR(RDATE, 1, 6)='202103')
WHERE RNUM BETWEEN 1 AND 5; -- 5개만 출력한다.

SELECT SEQ, ID, TITLE, CONTENT, RDATE, WDATE 
FROM CALENDAR 
WHERE SUBSTR(RDATE, 1, 8)='20210301';